<!DOCTYPE html>
<html>

<head>
    <title>LorenzTrajPlotter</title>
    <style>
        html,
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
        }

        canvas {
            width: 100vw;
            height: 100vh;
        }
    </style>
</head>

<body>
    <canvas id="myCanvas"></canvas>
    <script>
        // graphics
        const canvas = document.getElementById('myCanvas');
        const ctx = canvas.getContext('2d');
        const cursor = { x: 0, y: 0, down: false, clickX: 0, clickY: 0 };
        const viewPort = {
            x: 0,
            y: 0,
            scale: 10,
            dragX: 0,
            dragY: 0,
            minScale: 0.5,
            maxScale: 100,
        };
        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        addEventListener('resize', resizeCanvas);
        resizeCanvas();
        // dragging canvas and zooming
        canvas.addEventListener('mousemove', (e) => {
            cursor.x = e.clientX;
            cursor.y = e.clientY;
            if (cursor.down) {
                viewPort.dragX = (cursor.clickX - cursor.x) / viewPort.scale;
                viewPort.dragY = (cursor.clickY - cursor.y) / viewPort.scale;
            }
        });
        addEventListener('mousedown', (e) => {
            if (e.button === 0) {
                cursor.down = true;
                cursor.clickX = e.clientX;
                cursor.clickY = e.clientY;
            }
            else if (e.button === 2) {
                viewPort.x = 0;
                viewPort.y = 0;
                viewPort.scale = 10;
            }
        });
        addEventListener('contextmenu', (e) => e.preventDefault());
        addEventListener('mouseup', () => {
            cursor.down = false;
            viewPort.x += viewPort.dragX;
            viewPort.y += viewPort.dragY;
            viewPort.dragX = 0;
            viewPort.dragY = 0;
        });
        addEventListener('wheel', (e) => {
            const zoom = e.deltaY > 0 ? 0.9 : 1.1;
            viewPort.scale = Math.min(viewPort.maxScale, Math.max(viewPort.minScale, viewPort.scale * zoom));
            console.log(viewPort.scale);
        });
        // rendering
        function toScreenPos(x, y) {
            return {
                x: (x - viewPort.x - viewPort.dragX) * viewPort.scale + canvas.width / 2,
                y: (y - viewPort.y - viewPort.dragY) * viewPort.scale + canvas.height / 2,
            };
        }
        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = 'black';
            let testCentre = toScreenPos(0, 0);
            ctx.font = `${viewPort.scale}px Arial`;
            ctx.fillText('Hello World!', testCentre.x, testCentre.y);
            requestAnimationFrame(draw);
        }
        requestAnimationFrame(draw);
    </script>
</body>

</html>